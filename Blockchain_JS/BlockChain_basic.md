# 블록체인 개발

## 1. 비트코인과 암호화폐

- 비트코인 - 1세대 암호화폐

1. 비트코인 탄생 배경

   - 무정부 주의 및 사이버 펑크 운동

     ->정부로부터 개인의 사생활 보호 강조(익명성)

     ->정부 기관을 믿지 못하는 탈 중앙화 사상

   - 컴퓨터 공학 및 암호학의 발달

   - 2007년 미국발 글로벌 금융위기 발생. (서브 프라임 모기지 사태)

     ->투자처를 찾던 금융기관이 대규모 모기지론을 시행,

     ->주택 시장의 거품이 무너지면서 연쇄적인 파산

     ->대출금을 회수 하지 못한 금융기관 타격.

     ->리먼브라더스 파산 =>거대 은행도 파산할 수 있다는것을 보여준 사건.

   - 2008.10월 사토시 나카모토가 "***Bitcoin : A Peer-To-Peer Electronic Cash System***"이라는 논문을 공개.

   - 물리적인 형태가 없는 온라인 가상화폐, 단위는 BTC / XBT(외환쪽 용어)

   - 암호화 기술이 적용되어 암호화폐라고도 함.

   - 중앙기관 없이 네트워크 참여자간 P2P 방식으로 유통

   - 작업증명을 통해 신규 화폐 발행. 총 발행량은 2100만개로 한정

   - 비트코인의 가장 큰 과제는 P2P 상에서 악의적인 참여자를 막는 것.

2. 가상화폐 VS 암호화폐

   - 가상화폐란 ? "*규제되지 않은 디지털 화폐의 한가지 유형.*"
   - 암호화폐란 ? "*암호화 기술이 적용된 가상화폐*"

3. 비트코인 주요 목표

   - 중앙 기관 없이 당사자간 거래 가능 => **P2P 네트워크 사용**
   - 무분별한 화폐 발행 방지 => 2140년까지 **2100만개만 발행 제한**
   - 모든 거래내역은 공개 => **블록체인에 저장**
   - 악의적인 참가자에 의한 부정 방지 => **공개 분산 장부, 작업증명**
   - 거래 내역 위변조 방지 => **해시 함수를 이용한 체인**
   - 자발적인 참여 유도 => **작업 증명 시스템**
   - 본인 인증과 부인방지 => **참가자의 개인키를 이용한 전자서명**

4. **이슈 \#1. 악의적인 참가자에 의한 부정, 위변조**

   - 참가자 본인 인증과 부인방지
   - 악의적인 참여자에 의한 부정
   - 거래내역 위변조

5. 암호화 기술의 발전

   - 대칭키 암호화 방식
     - 1970년대 이전에는 암호화/복호화에 대칭키 방식을 사용
     - 암호를 걸고 푸는 쪽 모두 같은 키를 사용하는 방식
     - 사용자가 늘어날 때마다 키를 관리해야 하는 문제점 존재
   - 공개키 암호화 방식
     - 1976년에 대칭키 암호화 방식의 대안으로 제안
     - 암호화에 사용하는 키와 복호화에 사용하는 키를 분리
     - 하나는 Private Key로 가지고 있고, 나머지 하나를 Public Key로 공개
   - 전자 인증
     - 1977년 공개 키 암호 방식을 발전시킨 RSA 암호가 등장
     - RSA암호는 현재 전자상거래의 기반 기술인 디지털 서명에 이용

6. 전자 화폐의 등장

   - 1900년대의 전자화폐

     => 초기 전자 화폐는 DigiCash, HashCash, Bit-Gold, b-money 등

7. 비트코인 대중화

   - 2009년 10월 채굴한 BTC를 거래할 수 있는 'New Liberty Standard'거래소 탄생

     ->1달러당 1,309.03 BTC (BTC 채굴에 드는 전기요금 수준)

   - 2010년 5월 BTC를 이용한 첫 결제

     ->2010년 5월 19일 BTC 채굴자 Laszlo Hanyecz가 한 커뮤니티 게시판에 피자 2판을 배달해주면 10,000BTC를 지급하겠다는 게시글 등록

     ->2010년 5월 22일 Jercos라는 아이디를 가진 사람이 피자를 시켜주고 10,000BTC를 받음

   - 2010년 7월 11일에 비트코인 버전 0.3에 관한 기사 공개

     ->사람들의 관심을 받음, 채굴자 늘어남

   - 2010년 7월 18일에 Mt.Gox거래소 등장

     ->BTC 거래 대중화

8. 알트 코인

   - 비트 코인을 제외한 암호화폐를 알트코인 이라고 지칭

   - 비트코인의 문제점을 해결해 이를 대체하려는 움직임에서 시작

     ->통화 발행 구조 개선

     ->합의 알고리즘 개선

     ->처리 용량 및 속도 개선 등

   - 제 2의 비트코인을 찾는 투자자들의 자금을 끌어 모음.

   - 알트코인의 긍정적 효과

     ->암호화폐끼리 경쟁함으로써 암호화폐 시장의 지속적인 혁신을 야기.

     ->암호화폐 활성화에 기여

   - 알트코인의 부정적 효과

     ->제2,제3의 비트코인을 노리는 투기 세력

     ->묻지마 투자

     ->ICO이후 상장폐지 (사기)



## 2. 블록체인

1. 블록체인 이란?

   - 블록(Block)과 체인(Chain)의 합성어로 거래 내역이 담긴 블록을 체인처럼 엮어서 분산 저장하는 기술
   - 다른말로 분산원장기술 (Distributed Ledger Technology) 이라고도 함
   - 비트코인 등 암호화폐의 기반이 되는 기술

2. 블록체인에 대한 다양한 정의

   - 분산장부기술이다.
   - 신뢰하지 않는 사람들끼리도 시스템의 신뢰성을 바탕으로 거래를 할 수 있는 기술이다.
   - **분산원장**

3. 블록체인 구조

   - Genesis Block (최초의 블록)
   - Main Chain Block (메인 체인 블록)
   - Orphan Block (고아 블록)

4. 블록의 연결

   - 블록은 순서대로 연결되며 이전 블록의 해시값을 가지고 있다.

5. 블록체인 거래 방식

   - 기존 거래 방식 => 은행이 모든 거래내역을 장부로 관리
   - 블록체인 거래방식 => 분산된 장부를 통한 투명한 거래내역 유지

6. 분산 장부

   - 비트코인의 경우 10,000개 정도의 분산 장부 유지

7. 블록체인 거래 기록

   - 은행이 하는 일

     ->보관 : 거래 내역을 안전하게 보관하고 각 계정의 잔액 상태를 관리한다.

     ->검증 : 거래 발생 시 거래 내역에 문제가 없는지 검사

   - 은행 시스템의 구현

     ->은행이 하는 보관과 검증을 구현

     ->단, 단일 주체가 이 두가지를 다 하면 안됨.

     => 블록체인이 혁신인 이유는 이 문제를 해결했기 때문.

8. 블록체인 거래 검증

   - 누가 검증할 것인가?

     -> 검증자가 한 컴퓨터이면 해당 컴퓨터만 공격하면 전체 장부를 위조 가능

   - 블록체인 거래 내역 검증

     -> 매 블록마다 검증자를 바꿈

     -> 어떤 컴퓨터가 다음에 검증하게 될 지 모르는 구조

     -> 참여자가 많을수록 예측이 어려워짐.

     -> 검증을 위해 경쟁하는 시스템

   - 블록체인 검증 안전장치

     -> 검증을 위한 경쟁 시 '비용'이 발생

     ​	=>많은 돈을 쓰는 사람이 경쟁에서 유리

     -> 경쟁에서 이긴 검증자에게 합당한 보상

     ​	=>경쟁에서 이기더라도 검증을 잘 못하면 보상을 받지 못함.

     ​	=>경쟁에서 이기면 새로운 화폐를 발행해서 보상

9. 블록체인 장부의 조작

   - 장부의 조작

     -> 내가 가진 돈보다 더 큰 금액을 사용

     ​	=> 유효성 검증에서 통과하지 못함

     -> 이미 썼던 내용을 없애고 다시 사용

     ​	=>이미 썼던 내용은 이전 블록 어딘가에 저장

     ​	=> 해당 블록을 위조하기 위해서는 그 이후 모든 블록에 수정이 들어가야함

   - 공격자 입장

     ->블록을 생성하거나 조작하기 위해서는 더 많은 컴퓨팅 파워가 필요 (비용 발생)

     ->더 많은 비용을 들였다고 해서 블록 생성 권한을 얻는다는 보장이 없음

     ->특정 블록을 수정하면 그 블록에 연결된 체인이 다른 사람들이 가진 체인보다 더 길어야 네트워크에서 살아남음

10. 블록체인 기술의 장점

    1. 신뢰성을 보장할 제 3자가 필요 없다.
    2. 해킹에 안전하다.
    3. 거래내역이 투명하게 보관된다.
    4. 경제성이 뛰어나다.

11. 블록체인 단점

    1. 거래 속도가 느리다.
    2. 기록된 데이터를 수정하기 어렵다.
    3. 저장공간의 한계
    4. 프라이빗 키 분실위험

12. 핵심개념 - **P2P 네트워크 (초창기 개념)**

    - 중앙 서버없이 각 단말들이 서로 동등한 입장에서 통신하는 네트워크
    - 각 단말은 서버이면서 동시에 클라이언트
    - 네트워크 장애에 매우 강력함
    - P2P 시스템의 종류
      1. 퓨어 P2P
         - 인덱스 서버 없이 직접 노드간 연결
         - 주변 노드 탐색 필요
         - 네트워크 구조 제어 안됨
         - 장애 대응 및 확장성이 좋음
      2. 하이브리드 P2P
         - 노드의 검색 정보를 서버에 기록
         - 인덱스 서버에 노드 정보 저장
         - 연결 이후 데이터 전송은 Peer 끼리 직접

13. 핵심개념 - **해시 연산**

    - 데이터의 무결성을 보장하는 기술

      ->무결성은 데이터를 누구도 쉽게 변조할 수 없으며, 변조했다고 하더라도 그 사실을 바로 알아차릴 수 있는 특성

    - 해시(디지털 지문, DNA)

      ->특정한 데이터를 이를 상징하는 고정 길이의 데이터로 변환

      ->원래의 데이터가 조금만 달라져도 확연하게 달라지는 특성.

      ->복호화 (역변환) 불가, 비가역 함수

    - 해시 알고리즘

      ->대표적인 해시 알고리즘은 MD5, SHA-1, SHA-256 등

14. 블록체인에서의 해시 사용

    1. 계좌 생성
       - 프라이빗 키 -> 퍼블릭 키 -> 계정 주소 과정에서 사용
    2. 트랜잭션 머클 트리
       - 각 트랜잭션을 해시로 처리해서 거래 내역의 위변조를 방지
    3. 블록체인 연결
       - 앞 블록의 해시값으로 다음 블록 연결
    4. 작업 증명
       - 특정 조건에 맞는 해시값을 찾는 것이 문제

15. 핵심개념 - **공개키 및 지갑주소**

    - 개인키 - 무작위 숫자를 이용해 256bit 개인키 생성
    - 공개키 - 개인키에 ECDSA를 적용해 생성
    - 지갑주소 - 공개키를 이용해 생성         ->           비트코인 송수신 계좌

16. 핵심개념 - **블록**

    - 유효한 트랜잭션들의 집합, 블록체인 작업증명의 결과

    - 블록체인의 블록은 블록헤더+트랜잭션으로 구성

    - 태랜잭션 정보의 무결성 검증을 위해 머클 트리 사용.

    - 비트코인 블록 크기 : 1MB 가량, 약 2000개 트랜잭션 포함

    - 제네시스 블록 -> 해당 블록체인의 가장 첫번째 블록

    - 블록 높이

      ->제네시스 블록 이후 블록이 추가될 떄마다 1씩 증가

      ->현재까지 연결된 블록의 총 수

17. 핵심개념 - **트랜잭션**

    - 각 트랜잭션은 transaction id로 조회 가능
    - 입력값 : 출금될 계좌의 UTXO 들
    - 출력값 : 입금될 계좌의 UTXO 들

18. 핵심개념 - **합의 알고리즘**

    - 합의 내용

      ->블록 생성 권한을 누구에게 줄 것인가

      ->체인 분기 발생 시 메인 체인을 선택하는 방법

    - 합의 알고리즘의 종류

      ->PoW(Proof Of Work) : 작업증명

      ->PoS(Proof Of Stake) : 지분증명

      ->DPoS(Delegated Proof of Stake) : 위임 지분 증명

    - 작업증명(PoW) 알고리즘

      ->1999년 Markus Jakobsson과 Ari Juels가 제안한 서비스 부정 사용 방지 규칙

      ->동작 원리

      ​	=>서비스 제공자가 제시한 특정 작업을 완료해야 사용자가 서비스 이용 가능

      ​	=>작업을 하기는 어려워도 '작업완료' 검증은 쉬운 작업

    - 작업 증명(PoW)

      -> 비트코인에서는 작업증명(PoW) 방식의 합의 알고리즘 사용

      -> 해당 블록 헤더의 해시값이 특정 범위 안에 들도록 하는 것이 작업 과제

      -> 해시값은 예측이 불가능 하기 떄문에 입력을 조금씩 바꿔가며 다시 연산을 해보는 수 밖에 없음

      -> 입력 값을 바꾸기 위해 Nonce값 변경

      -> 작업 증명을 통과한 사용자는 새로 발행된 비트코인을 보상으로 받음

      => 이 과정을 ***채굴***이라고 함

19. 핵심개념 - **전자 서명**

    - 안전하지 않은 공용 네트워크 상에서 전자 서명을 통해 신뢰성을 검증하는 기술
    - 사용자 별로 개인키와 공개키로 이루어진 키의 쌍이 존재
    - 송신자의 개인키로 암호화 하면 수신자는 송신자의 공개키로 복호화 가능
    - 키 교환 없이 안전하게 데이터를 수신할 수 있음
    - 트랜잭션의 부인방지에 사용

20. 핵심개념 - **블록 생성 및 전파**

    - 거래 발생 시 모든 사용자에게 전파
    - 각 사용자는 새로운 거래 내역을 블록에 취합
    - 각 사용자는 해당 블록에 대한 작업증명 시도
    - 어떠한 사용자가 작업 증명에 성공하면 해당 블록을 모든 사용자에게 전파
    - 다른 사용자는 해당 블록이 유효한 경우 승인